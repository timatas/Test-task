{"version":3,"file":"commonHelpers2.js","sources":["../src/js/favorite.js"],"sourcesContent":["import { createMarkupCart } from './template.js';\nimport addCounter from './cart-header-counter.js';\nconst title = document.querySelector('.products-quantity-title');\n\nconst containerCart = document.querySelector('.cart-container');\nconst cartWrapper = document.querySelector('.cart-desktop-wrapper');\nconst emptyCart = document.querySelector('.cart-empty');\nconst deleteAllBtn = document.querySelector('.del-all-wrapper');\nconst KEY = 'products in cart';\n\nconst formEmailRet = document.querySelector('.form-checkout');\nconst formInputRet = document.getElementById('.inputEmail');\nconst btnSumbit = document.querySelector('.btnCheckout');\n\nrenderCart();\n\n// очистка всієї корзини (localStorage)\ndeleteAllBtn.addEventListener('click', clearCart);\nfunction clearCart() {\n  localStorage.removeItem(KEY);\n  renderCart();\n}\n\n// якщо localStorage пустий, показувати розмітку пустої корзини\n// і приховувати розмітку товарів.\n// Викликається в cart.page.js\nexport function renderCart() {\n  addCounter();\n  const products = JSON.parse(localStorage.getItem(KEY));\n\n  if (products === null || products === undefined || products.length === 0) {\n    cartWrapper.style.display = 'none';\n    emptyCart.style.display = 'block';\n    containerCart.innerHTML = '';\n    title.textContent = 'Favorite (0)';\n    //totalPrice.textContent = '$0';\n  } else {\n    containerCart.innerHTML = '';\n    // cartWrapper.style.display = 'flex';\n    emptyCart.style.display = 'none';\n\n    containerCart.insertAdjacentHTML('beforeend', createMarkupCart(products));\n  }\n}\n\n// видалення конкретного продукту\n// можна оптимізувати ??\ncontainerCart.addEventListener('click', removeProduct);\nfunction removeProduct(event) {\n  if (\n    event.target.className !== 'remove-btn' &&\n    event.target.className !== 'remove-btn-img'\n  ) {\n    return;\n  }\n\n  const selectedItem = event.target.closest('.cart-list-item');\n  const selectedItemId = selectedItem.id;\n  const products = JSON.parse(localStorage.getItem(KEY));\n  const index = products.findIndex(item => item._id === selectedItemId);\n\n  products.splice(index, 1);\n  localStorage.setItem(KEY, JSON.stringify(products));\n  selectedItem.remove();\n  addCounter();\n\n  if (products === null || products === undefined || products.length === 0) {\n    renderCart();\n    return;\n  }\n}\n\n// віднімання і додавання кількості продукту\n// логіка в тому, щоб дозволити юзеру мати 0 продуктів не видаляючи його\n// з першого разу, але на другий клік по мінусу він видаляється\n// (на випадок того, коли випадково проклікав, щоб мати змогу доддати кількість знову).\n// !!!\n// на майбутнє - треба прописати логіку, щоб при кліку на checkout\n// юзеру вилітало повідомлення, щоб або видалив, або додав кількість більше за 0.\n// Тобто, при кліку на кнопку Checkout, треба пройтись по localStorage(KEY), і якщо є хоч один обєкт з quantity: 0, вивести повідомлення\ncontainerCart.addEventListener('click', changeQuantity);\nfunction changeQuantity(event) {\n  if (\n    event.target.className !== 'more-btn-img' &&\n    event.target.className !== 'less-btn' &&\n    event.target.className !== 'more-btn-card' &&\n    event.target.className !== 'less-btn-img'\n  ) {\n    return;\n  }\n\n  const selectedItem = event.target.closest('.cart-list-item');\n  const selectedItemId = selectedItem.id;\n  const products = JSON.parse(localStorage.getItem(KEY));\n  const index = products.findIndex(item => item._id === selectedItemId);\n  const productQuantity = selectedItem.querySelector('.products-quantity');\n\n  // тут обробляємо додавання\n  if (\n    event.target.className === 'more-btn-card' ||\n    event.target.className === 'more-btn-img'\n  ) {\n    products[index].quantity++;\n    productQuantity.innerHTML = products[index].quantity;\n    localStorage.setItem(KEY, JSON.stringify(products));\n  }\n\n  // тут обробляємо віднімання\n  if (\n    event.target.className === 'less-btn' ||\n    event.target.className === 'less-btn-img'\n  ) {\n    // тут не даємо обрати кількість менше 1\n    if (products[index].quantity === 1) {\n      return;\n    }\n    // віднімання\n    products[index].quantity--;\n    productQuantity.innerHTML = products[index].quantity;\n    localStorage.setItem(KEY, JSON.stringify(products));\n  }\n}\n\n// обрахунок суми кошика\n// function countTotal(obj) {\n//   title.textContent = `Cart (${obj.length})`;\n//   const total = obj.reduce((acc, { quantity, price }) => {\n//     return (acc += quantity * price);\n//   }, 0);\n//   totalPrice.textContent = `$${total.toFixed(2)}`;\n// }\n\n//email and checkout\nformEmailRet.addEventListener('sumbit', function (evt) {\n  if (!formEmailRet.value) {\n    alert('Please enter a valid email');\n\n    //return;\n  }\n});\n\n//modal window\n\n//const closeBtn = document.querySelector(\".btn-close\")\nconst btnCheckout = document.querySelector('.btnCheckout');\nconst modalCheckout = document.querySelector('.modal');\nconst formOrder = document.querySelector('#formCheckoutEmail');\nconst inputOrder = document.querySelector('#formCheckoutInput');\n\nformOrder.addEventListener('submit', handleOrder);\n//inputOrder.addEventListener('keyup', handleKeyPress);\n\nfunction handleOrder(event) {\n  event.preventDefault();\n  const email = inputOrder.value.trim();\n  const products = JSON.parse(localStorage.getItem(KEY));\n\n  const productsInCart = products.reduce((acc, { quantity }) => {\n    return (acc += quantity);\n  }, 0);\n\n  if (productsInCart === 0) {\n    alert(`You must add products' quantity!`);\n    return;\n  }\n\n  if (email === '') {\n    alert('Please enter an email address');\n    return;\n  }\n\n  sendDataToServer({ email })\n    .then(() => {\n      console.log('Data sent successfully');\n      inputOrder.value = '';\n      clearCart();\n      modalCheckout.style.display = 'block';\n    })\n    .catch(error => {\n      console.error('There was a problem with the fetchoperation:', error);\n    });\n}\n\nvar span = document.getElementsByClassName('close')[0];\n\nspan.onclick = function () {\n  modalCheckout.style.display = 'none';\n};\n\nwindow.onclick = function (event) {\n  if (event.currentTarget.className !== 'modal') {\n    modalCheckout.style.display = 'none';\n  }\n};\n\nfunction sendDataToServer(data) {\n  return new Promise((resolve, reject) => {\n    setTimeout(() => {\n      console.log('Imitating sending data to server:', data);\n      resolve();\n    }, 2000);\n  });\n}\n"],"names":["title","containerCart","cartWrapper","emptyCart","deleteAllBtn","KEY","formEmailRet","renderCart","clearCart","addCounter","products","createMarkupCart","removeProduct","event","selectedItem","selectedItemId","index","item","changeQuantity","productQuantity","evt","modalCheckout","formOrder","inputOrder","handleOrder","email","acc","quantity","sendDataToServer","error","span","data","resolve","reject"],"mappings":"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"}