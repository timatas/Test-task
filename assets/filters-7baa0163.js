import{P as B,a as w,S as P}from"./vendor-4b9aba64.js";import{a as y,b as L,d as A,e as T}from"./scroll-0cb9cff9.js";const I=document.getElementById("pagination");let m=0;const C=window.innerWidth;C<768?m=2:m=4;function O(t,e,o){const s={totalItems:t.totalPages*e,itemsPerPage:e,visiblePages:m,page:o,centerAlign:!1,template:{page:'<a href="#" class="tui-page-btn">{{page}}</a>',currentPage:'<strong class="tui-page-btn tui-is-selected">{{page}}</strong>',moveButton:'<a href="#" class="tui-page-btn tui-{{type}}"><span class="tui-ico-{{type}}">{{type}}</span></a>',disabledMoveButton:'<span class="tui-page-btn tui-is-disabled tui-{{type}}"><span class="tui-ico-{{type}}">{{type}}</span></span>',moreButton:'<a href="#" class="tui-page-btn tui-is-disabled tui-{{type}}-is-ellip"><span class="tui-ico-ellip">...</span></a>'}};new B(I,s).on("afterMove",r=>{const a=r.page;var c=JSON.parse(localStorage.getItem("filters"))||{};c.page=a,localStorage.setItem("filters",JSON.stringify(c)),u()})}function q(){I.innerHTML=""}async function M(t,e,o,s,n){try{const r={keyword:e||"",category:t||"",page:o||1,limit:s||6};n&&(r.sort=n);const a=await w({method:"get",url:"https://food-boutique.b.goit.study/api/products",params:r});return a.data.totalPages>1?O(a.data,s,o):q(),a.data.results}catch(r){return console.error("Error fetching products:",r),[]}}async function d(t){return(await w(`https://food-boutique.b.goit.study/api/products/${t}`)).data}const h="/Test-task/assets/check-267a6277.svg",_=document.querySelector(".products-container"),k=document.querySelector(".popular-container"),v=document.querySelector(".discount-container"),l="products in cart";function b(t){const e=document.querySelector(".products-container");!t||t.length===0?e.innerHTML=`<div class="cart-empty empty-filter">
           <h3 class="products-titel">Nothing was found for the selected <span>filters...</span></h3>
           <p class="filters-text-not-found">Try adjusting your search parameters or browse our range by other criteria to find the perfect product for you.</p>
       </div>`:e.innerHTML=L(t)}function D(t){for(let e=t.length-1;e>0;e--){const o=Math.floor(Math.random()*(e+1));[t[e],t[o]]=[t[o],t[e]]}}async function J(){try{const t=await d("popular"),e=j(t),o=E(e,5);k.innerHTML=A(o)}catch(t){console.log(t.message)}}J();function E(t,e){return D(t),t.slice(0,e)}async function H(){try{const t=await d("discount"),e=E(t,2);v.innerHTML=T(e)}catch(t){console.log(t.message)}}v.addEventListener("click",F);async function F(t){if(t.target.className==="discount-link-basket"||t.target.className==="discount-basket-icon"||t.target.className==="discount-basket-icon"){const e=t.target.closest(".discount-list-item"),o=e.id;try{const s=await d(o),n=JSON.parse(localStorage.getItem(l))??[],r=n.findIndex(a=>a._id===o);if(r!==-1)n[r].quantity+=0;else{s.quantity=1,n.push(s);const a=e.querySelector("button");a.disabled=!0,a.innerHTML=`<span class="icon-styles">
                     <img class="discount-basket-icon" src="${h}" alt="icon bascket" width="18" height="18">

                  </span>`,a.classList.add("disabled")}localStorage.setItem(l,JSON.stringify(n)),y()}catch(s){console.log(s.message)}}}H();_.addEventListener("click",$);async function $(t){if(t.target.nodeName==="BUTTON"||t.target.className==="add-btn"||t.target.nodeName==="IMG"){const e=t.target.closest(".list-item-body-price");if(e&&e.parentElement){const o=e.parentElement.id;try{const s=await d(o),n=JSON.parse(localStorage.getItem(l))??[],r=n.findIndex(a=>a._id===o);if(r!==-1)n[r].quantity+=0;else{s.quantity=1,n.push(s);const a=e.querySelector("button");a.disabled=!0,a.innerHTML=`<img src="${h}" alt="icon check" width="18" height="18">`,a.classList.add("disabled")}localStorage.setItem(l,JSON.stringify(n)),y()}catch(s){console.error(s.message)}}}}k.addEventListener("click",z);async function z(t){if(t.target.nodeName==="BUTTON"||t.target.className==="popular-basket-img"){const e=t.target.closest(".product-popular-card"),o=e.id,s=e.querySelector("button");s.disabled=!0;try{const n=await d(o),r=JSON.parse(localStorage.getItem(l))??[],a=r.findIndex(c=>c._id===o);a!==-1?r[a].quantity+=0:(n.quantity=1,r.push(n),s.innerHTML=`<img class="popular-disadbled-img" src="${h}" alt="icon bascket" width="20" height="20">`,s.classList.add("popular-disadbled-btn")),localStorage.setItem(l,JSON.stringify(r)),y()}catch(n){console.log(n.message),s.disabled=!1}}}function j(t){return t.map(e=>{let o=e.category;return typeof o=="string"&&(o=o.split("_").join(" ")),{...e,category:o}})}let f=!1;function R(t,e,o){let s;return function(){const n=this,r=arguments,a=function(){s=null,o||t.apply(n,r)},c=o&&!s;clearTimeout(s),s=setTimeout(a,e),c&&t.apply(n,r)}}document.addEventListener("DOMContentLoaded",function(){Q(),Y(),V(),K(),Z();const t=document.getElementById("search-box"),e=document.getElementById("categories"),o=document.getElementById("sort-options"),s=g();t.value=s.keyword||"",e.value=s.category||"",o.value=s.sort||"",u()});const U=document.querySelector(".search-form");U.addEventListener("submit",function(t){t.preventDefault();const e=document.getElementById("search-box").value.trim();p("keyword",e),u(),N()});function W(){const t=window.innerWidth,e=t>=768&&t<1150;let o=6;e?o=8:t>=1150&&(o=9);const s=g();s.limit=o,localStorage.setItem("filters",JSON.stringify(s)),u()}window.addEventListener("resize",R(W,300));async function Z(){try{const t=await fetch("https://food-boutique.b.goit.study/api/products/categories");if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const e=await t.json();e&&e.length>0?G(e):console.error("No categories found")}catch(t){console.error("Error fetching categories:",t)}}function G(t){const e=document.getElementById("categories");e.innerHTML="";const o=[{text:"Show all",value:""},...t.map(s=>({text:s.replace(/_/g," "),value:s}))];new P({select:"#categories",placeholder:"Categories",showSearch:!1,data:o})}function K(){new P({select:"#sort-options",data:[{text:"A to Z",value:"byABC_Asc"},{text:"Z to A",value:"byABC_Desc"},{text:"Cheap",value:"byPrice_Asc"},{text:"Expensive",value:"byPrice_Desc"},{text:"Popular",value:"byPopularity_Asc"},{text:"Not popular",value:"byPopularity_Desc"},{text:"Show all",value:"showAll"}]})}function Y(){const t=document.getElementById("categories"),e=document.getElementById("sort-options");t.addEventListener("change",S),e.addEventListener("change",S)}function S(){const t=document.getElementById("categories").value,e=document.getElementById("sort-options").value;p("category",t),p("sort",e),u(),N()}function N(){p("page",1)}async function u(){if(f)return;f=!0;const t=g(),{category:e,keyword:o,page:s,limit:n,sort:r}=t;try{const a=await M(e,o,s,n,r);if(!Array.isArray(a))throw new Error("Response is not an array of products");switch(r){case"byABC_Asc":a.sort((c,i)=>c.name.localeCompare(i.name));break;case"byABC_Desc":a.sort((c,i)=>i.name.localeCompare(c.name));break;case"byPrice_Asc":a.sort((c,i)=>c.price-i.price);break;case"byPrice_Desc":a.sort((c,i)=>i.price-c.price);break;case"byPopularity_Asc":a.sort((c,i)=>c.popularity-i.popularity);break;case"byPopularity_Desc":a.sort((c,i)=>i.popularity-c.popularity);break}b(a)}catch(a){console.error("Error fetching products:",a),b([])}finally{f=!1}}function Q(){localStorage.getItem("filters")||x()}function p(t,e){const o=g();o[t]=e,localStorage.setItem("filters",JSON.stringify(o))}function x(){localStorage.setItem("filters",JSON.stringify({keyword:null,category:null,page:1,limit:6}))}function g(){return JSON.parse(localStorage.getItem("filters"))||x()}function V(){u()}export{$ as a,d as f};
//# sourceMappingURL=filters-7baa0163.js.map
